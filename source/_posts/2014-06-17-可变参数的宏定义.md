title: 可变参数的宏定义
date: 2014-06-17 10:40:23
tags:
---
## Example code ##
```
#include <stdio.h>
#include <stdarg.h>
#define recv(fmt,args...) do{ \
        printf((char*)fmt,##args);\
        systemCall((char*)fmt,##args);\
}while(0)
#define FILENAME "/tmp/1"
int systemCall(const char* fmt, ...){
        char buf[1024] = {0};

        va_list argp;
        va_start( argp, fmt );
        vsnprintf(buf,sizeof(buf)-1,fmt,argp);
        va_end( argp );

        system(buf);
}

int main(int argc, char* argv[]) {
        recv("echo \"%d\" > /tmp/%d\n",1,10);
        systemCall("echo \"%d\" > " FILENAME,10);
        system("mtd erase " FILENAME);
}
```
